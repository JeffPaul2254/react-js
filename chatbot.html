<!DOCTYPE html>
<html>
  <head>
    <title>CHATBOT</title>
  </head>
  <body>
    <div class="js-container"></div>
   
    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>

    <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>

    <script src="https://unpkg.com/supersimpledev/babel.js"></script>
    <script type="text/babel">

      function ChatInput({chatMessages, setChatMessages}) {
        const [inputText, setInputText] = React.useState('');

        function saveInputText(event) {
          setInputText(event.target.value);
        }

        function sendMessage() {
          const newChatMessages = [
        ...chatMessages,
        {
          message: inputText,
          sender: 'user',
          id: crypto.randomUUID()
        }
      ];

      const response = Chatbot.getResponse(inputText);
      setChatMessages([
        ...newChatMessages,
        {
          message: response,
          sender: 'robot',
          id: crypto.randomUUID()
        }
      ]);

      setInputText('');
    }

        return (
          <>
            <input 
              placeholder="Send a Message to ChatBot" 
              size="30" 
              onChange={saveInputText}
              value={inputText}
            />
            <button
              onClick={sendMessage}
            >Send</button>
          </>
        );
      }

      function ChatMessage({ message, sender }) {

        //const message = props.message;
        //const sender = props.sender;

        //const { message, sender } = props;

        /*
        if(sender === 'robot') {
          return (
            <div>
              {message}
              <img src="robot.png" width="50" />
            </div>
          )
        }
        */

          return (
            <div>
              {sender === 'robot' && (
                <img src="robot.png" width="50" />
              )}
               {message}
              {sender === 'user' && (
                <img src="user.png" width="50" />
              )}

          </div>
        );
      }

      //updater functions
      function ChatMessages({ chatMessages}) {
  /*function sendMessage() {
      setChatMessages([
        ...chatMessages,
        {
          message: 'test',
          sender: 'user',
          id: crypto.randomUUID()
        }
      ]);
      }
      */

      console.log(chatMessages);

  return (
    <>

      {chatMessages.map((chatMessage) => {
        return (
          <ChatMessage
            message={chatMessage.message}
            sender={chatMessage.sender}
            key={chatMessage.id}
          />
        );
      })}
    </>
        );
    }

      function App() {

        const [chatMessages, setChatMessages] = React.useState([
          { message: 'hello chatbot', sender: 'user', id: 'id1' },
          { message: 'Hello! How Can I help You?', sender: 'robot', id: 'id2' },
          { message: 'Can you get me todays date?', sender: 'user', id: 'id3' },
          { message: 'February 17', sender: 'robot', id: 'id4' }
        ]);
        // const chatMessages = array[0];
        // const setChatMessages = array[1];
        // const [chatMessages, setChatMessages] = array;

        return (
          <>
              <ChatInput 
              chatMessages={chatMessages}
              setChatMessages={setChatMessages}
              />
              <ChatMessages 
              chatMessages={chatMessages}
              />
            </>
        );
      }

      const container = document.querySelector('.js-container');
      ReactDOM.createRoot(container).render(<App />);
    </script>
  </body> 
</html> 